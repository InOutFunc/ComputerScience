# 存储管理

存储代码和数据

层次结构

申请内存和归还内存

## 计算机体系结构

寄存器

内存，最小访问单位字节，一次读写32位

高速缓存

## 内存层次

高速缓存未命中，

内存，

缺页外存（虚拟内存）

## 内存管理

* 抽象
  * 逻辑地址
* 保护
  * 独立地址空间
* 共享
  * 访问相同内存
* 虚拟化
  * 更大的地址空间

## 内存管理方式

* 重定位
* 分段
* 分页
* 虚拟存储

# 地址空间和地址生成

## 地址空间定义

* 物理地址空间-硬件支持的地址空间
* 逻辑地址空间-在cup运行的进程看到的地址

## 逻辑地址生成

![image-20200831161219172](C:\Users\c00518663\AppData\Roaming\Typora\typora-user-images\image-20200831161219172.png)

## 地址生成时机和限制

* 编译时
  * 起始地址改变，必须重新编译
* 加载时
  * 加载时，生成绝对地址
* 执行时
  * 执行时代码可移动
  * 需地址转换（映射）硬件

## 地址生成过程

* cpu
  * ALU: 需要逻辑地址的内存内容
  * MMU: 进行逻辑地址和物理地址的转换
  * cpu控制逻辑：给总线发送物理地址请求
* 内存
  * 发送物理地址的内容给cpu
  * 或接收cpu数据到物理地址
* 操作系统
  * 建立逻辑地址和LA和物理地址PA的映射

# 连续内存分配

## 内存碎片

* 外部碎片
* 内部碎片

## 动态分区分配

* 动态分区分配
* 操作系统需要维护的数据结构
  * 所有进程的已分配分区
  * 空闲分区
* 动态分区分配策略
  * 最先分配
  * 最佳分配