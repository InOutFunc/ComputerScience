## 1

server层：连接器，查询缓存，分析器，优化器，执行器。

存储引擎层：innodb, myisam。

1. 连接器

```mysql
mysql -h$ip -P$port -u$user -p
```

2. 查询缓存

key是查询的语句，value是查询的结果

查询缓存往往弊大于利

MySQL 8.0 版本直接将查询缓存的整块功能删掉了

3. 分析器

词法分析

语法分析

4. 优化器

优化器是在表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序。

5. 执行器

开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限

# 2

redo log. binlog

write-ahead logging

innodb的redo log是固定大小的，

write pos 是当前记录的位置，一边写一边后移，写到第 3 号文件末尾后就回到 0 号文件开头。checkpoint 是当前要擦除的位置，也是往后推移并且循环的，擦除记录前要把记录更新到数据文件。

