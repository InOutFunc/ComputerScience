# 传输层

## 概念

主机才有的层次

为应用层提供通信服务，使用网络层的服务

* 功能：
  * 进程和进程之间的逻辑通信
  * 复用和分用 
  * 收到的报文进行差错检测
  * tcp/udp



面向连接的传输控制协议tcp：可靠，面向连接，时延大，适用于大文件

无连接的用户数据报协议udp：不可靠，无连接，适用于小文件



* 传输层的寻址与端口
  * 复用：应用层的所有应用进程，通过传输层传输到网络层
  * 分用：传输层从网络层收到数据后交付指明的应用进程
  * 端口：传输层的sap，标识主机中的应用进程。逻辑端口/软件端口
  * 端口号只有本地意义
  * 16bit，65536
  * 端口号：熟知端口号、登记端口号
  * 套接字：主机ip地址：端口号，标识主机和一个进程

## udp

只在ip数据报服务上增加很少功能，复用、分用和差错检测功能

* udp主要特点
  * 无连接的，减少开销和时延
  * 最大努力交付，不保证可靠交付，应用层保证
  * 面向报文，一次性传输少量数据的网络应用
  * 无拥塞控制，适合很多实时应用
  * 首部开销小，8B
* 首部格式
  * 16位源端口号（可有可无，看是否需要回信）
  * 16位目的端口号
  * 16位udp长度（首部 + 数据字段）
  * 16位udp检验和（检测整个upd是否有错，错就丢弃）
* udp校验
  * 伪首部只在计算校验和时才出现
  * 发送端：反码求和求反码填入校验和字段，相当于将发送信息带入了，接收端根据该信息来判断是否错误
  * 接收端：求和，此时求和校验和字段和发送端求和时不同，带上了判断信息

