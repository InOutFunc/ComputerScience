## 特点

1. 面向连接（虚连接）
2. 点对点，不能广播和多播
3. 可靠有序，不丢不重
4. 全双工，发送缓存，接收缓存
5. 面向字节流，无结构的字节流

## tcp报文段首部格式

源端口 + 目的端口

序号：本报文段所发送数据的第一个字节的序号

确认号：期望收到对方下一个报文段的第一个数据字节的序号

数据偏移 + 保留 + URG + ACK + PSH + RST + SYN + FIN + 窗口

检验和 + 紧急指针

选项 + 填充

 ## tcp连接管理

客户服务器方式

round1: 客户端发送连接请求报文段 syn = 1, seq = x(随机)

round2: 分配缓存和变量，确认报文段，无应用层数据。

syn = 1, ack = 1, seq = y, acknum = x + 1

round3: 分配缓存和变量，

syn = 0, ack = 1, seq = x + 1, ack = y + 1

### 连接释放

round1: 客户端发送连接释放报文段fin = 1, seq = u

round2: 服务器回送一个确认报文段

ack = 1, seq = v, ack = u + 1

round3: 服务器发送连接释放报文段

fin = 1, ack = 1, seq = w, acknum = u + 1

round4: 客户端回送一个确认报文段

ack = 1, seq = u + 1, acknum = w + 1

## tcp可靠传输

接收到的和发送的是完全一样的

1. 校验

与udp校验一样，增加伪首部

2. 序号

一个字节占一个序号

序号字段：一个报文段第一个字节的序号

累计确认：

3. 重传

超时重传

自适应算法，加权平均往返时间

冗余ACK：

1， 1， 2

3， 1， 2

4， 1， 2

发送方收到2个对于报文段1的冗余ACK。 快速重传

## tcp流量控制

让发送方慢点，接收方来得及接收

tcp利用滑动窗口机制实现流量控制

发送窗口 = min（接收窗口，拥塞窗口）

## tcp拥塞控制

出现拥塞的条件：对资源需求的总和 > 可用资源

防止过多的数据注入到网络中：全局性

假定：

1. 数据单方向传送
2. 发送窗口取决于拥塞程度

四种算法：

1. 慢开始和拥塞避免

cwnd = 1

ssthresh门限值

2. 快重传和快恢复

3个冗余ack，执行快速重传算法

不用降到1，降到新的ssthresh门限值